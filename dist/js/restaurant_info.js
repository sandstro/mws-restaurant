"use strict";var restaurant=void 0,map=void 0;window.initRestaurantMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(t),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map),self.map.addListener("tilesloaded",function(){return document.querySelector("#map iframe").setAttribute("title","Location on Google Maps")}))})};var fetchRestaurantFromURL=function(n){if(self.restaurant)n(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)?(fillRestaurantHTML(),n(null,t)):console.error(e)}):(error="No restaurant id in URL",n(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img",t.alt="An image of "+e.name+" in "+e.neighborhood,t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&!nodeHasContent("#restaurant-hours")&&fillRestaurantHoursHTML(e.operating_hours),DBHelper.fetchReviews(e.id).then(function(e){fillReviewsHTML(e)})},handleSubmit=function(){event.preventDefault();var e=getParameterByName("id"),t=document.querySelector('input[name="name"]').value,n=document.querySelector('select[name="rating"] option:checked').value,r=document.querySelector('textarea[name="comment"]').value,a={createdAt:new Date,restaurant_id:parseInt(e),rating:parseInt(n),name:t,comment:r};DBHelper.postReview(a),fillSubmittedReviewHTML(a),document.querySelector("form").reset()};fillSubmittedReviewHTML=function(e){var t=document.querySelector(".reviews--none");t&&t.remove();var n=document.querySelector("#reviews-container"),r=document.querySelector("#reviews-list");r.insertBefore(createReviewHTML(e),r.firstChild),n.appendChild(r)};var fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),a=document.createElement("td");a.tabIndex=0,a.innerHTML=n,r.appendChild(a);var i=document.createElement("td");i.tabIndex=0,i.innerHTML=e[n],r.appendChild(i),t.appendChild(r)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.id="reviews__heading",n.innerHTML="Reviews",t.appendChild(n),!e){var r=document.createElement("p");return r.className="reviews--none",r.innerHTML="No reviews yet!",void t.appendChild(r)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),t.appendChild(a)},createReviewHTML=function(e){var t=document.createElement("li"),n=document.createElement("p");if(n.innerHTML=e.name,!navigator.onLine){var r=document.createElement("div");r.className="restaurant__review__offline__label",r.style.background="#f00",r.style.color="#fff",r.style.paddingLeft="1em",r.innerHTML="Connection lost!",t.appendChild(r)}t.appendChild(n);var a=document.createElement("p");a.innerHTML=new Date(e.createdAt),t.appendChild(a);var i=document.createElement("p");i.innerHTML="Rating: "+e.rating,t.appendChild(i);var o=document.createElement("p");return o.innerHTML=e.comments||e.comment,t.appendChild(o),t},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb");if(1===t.children.length){var n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},nodeHasContent=function(e){return 0<document.querySelector(e).children.length};
//# sourceMappingURL=restaurant_info.js.map
